import{j as s,u as B,r as j}from"./use-openai-global-C-kWgFLb.js";/* empty css                    */import{c as O}from"./client-rURR1_t4.js";import{u as P,a as D}from"./use-theme-Bge9D-4o.js";import{u as R}from"./use-send-followup-C7M1JOv-.js";function r(...e){for(const a of e)if(typeof a=="string"&&a.trim())return a.trim()}function u(...e){for(const a of e){if(typeof a=="number"&&Number.isFinite(a))return a;if(typeof a=="string"){const n=Number(a);if(Number.isFinite(n))return n}}}const G={So11111111111111111111111111111111111111112:"SOL",EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v:"USDC",Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB:"USDT"};function b(e){return e?G[e]??e.slice(0,4).toUpperCase():"TOKEN"}function S(e){return e===void 0?"—":Math.abs(e)>=1?e.toLocaleString("en-US",{maximumFractionDigits:4}):e.toLocaleString("en-US",{maximumFractionDigits:6})}function W(e){return e===void 0?"—":`${e>=0?"+":""}${e.toFixed(2)}%`}function z(e,a=4,n=4){return e.length<=a+n+3?e:`${e.slice(0,a)}…${e.slice(-n)}`}function k({symbol:e,imageUrl:a,size:n=56}){const[i,c]=j.useState(!1),l=a&&!i;return s.jsx("div",{className:"swap-token-icon",style:{width:n,height:n},children:l?s.jsx("img",{src:a,alt:e,onError:()=>c(!0),referrerPolicy:"no-referrer"}):s.jsx("span",{className:"swap-token-icon__fallback",style:{fontSize:n*.3},children:e.slice(0,2)})})}function K({fromSymbol:e,fromAmount:a,fromImage:n,toSymbol:i,toAmount:c,toImage:l}){return s.jsxs("div",{className:"swap-flow",children:[s.jsxs("div",{className:"swap-flow__side",children:[s.jsx(k,{symbol:e,imageUrl:n,size:56}),s.jsxs("div",{className:"swap-flow__info",children:[s.jsx("span",{className:"swap-flow__amount",children:a}),s.jsx("span",{className:"swap-flow__symbol",children:e})]})]}),s.jsx("div",{className:"swap-flow__arrow",children:s.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",children:s.jsx("path",{d:"M5 12h14M13 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),s.jsxs("div",{className:"swap-flow__side swap-flow__side--to",children:[s.jsx(k,{symbol:i,imageUrl:l,size:56}),s.jsxs("div",{className:"swap-flow__info",children:[s.jsx("span",{className:"swap-flow__amount swap-flow__amount--receive",children:c}),s.jsx("span",{className:"swap-flow__symbol",children:i})]})]})]})}function w({onClick:e,label:a,loadingLabel:n,isLoading:i,disabled:c,variant:l="secondary"}){return s.jsx("button",{className:`swap-action-btn swap-action-btn--${l}`,onClick:e,disabled:i||c,children:i?n||"Loading...":a})}function Q(){const e=B("toolOutput"),a=P(),{callTool:n,isLoading:i}=D(),c=R(),[l,_]=j.useState("idle"),[N,x]=j.useState(null),t=e?e.result??e.quote??e:null;if(!t)return s.jsx("div",{className:"swap-container","data-theme":a,children:s.jsxs("div",{className:"swap-loading",children:[s.jsx("div",{className:"swap-loading__spinner"}),s.jsx("span",{children:"Building swap quote..."})]})});const d=r(t.inputMint),o=r(t.outputMint),F=r(t.inputToken?.symbol)??b(d),h=r(t.outputToken?.symbol)??b(o),I=r(t.inputToken?.imageUrl,t.inputLogo),E=r(t.outputToken?.imageUrl,t.outputLogo),m=u(t.amountUi,t.inAmountUi),L=u(t.expectedOutputUi,t.outAmountUi),p=u(t.priceImpactPct),f=u(t.slippageBps),g=u(t.networkFeeSol),C=r(t.route,t.routeLabel)??"Jupiter",v=r(t.quoteId,t.swapId),M=p!==void 0&&p>1,U=p!==void 0&&p<0,T=async()=>{if(!d||!o)return;_("idle"),x(null),await n("solana_swap_execute",{inputMint:d,outputMint:o,amount:m,slippageBps:f||100})?(_("success"),x("Swap executed successfully!")):(_("error"),x("Failed to execute swap"))},A=async()=>{o&&await n("slippage_sentinel",{token_out:o,token_in:d,amount_in_ui:m})},$=async()=>{await c(`Tell me more about ${h} (${o})`)},q=async()=>{!d||!o||await n("solana_swap_preview",{inputMint:d,outputMint:o,amount:m})};return s.jsx("div",{className:"swap-container","data-theme":a,children:s.jsxs("div",{className:"swap-card",children:[s.jsxs("div",{className:"swap-card__header",children:[s.jsx("span",{className:"swap-card__title",children:"Swap Preview"}),s.jsx("span",{className:"swap-card__badge",children:C})]}),s.jsx(K,{fromSymbol:F,fromAmount:S(m),fromImage:I,toSymbol:h,toAmount:S(L),toImage:E}),s.jsxs("div",{className:"swap-card__metrics",children:[p!==void 0&&s.jsxs("div",{className:"swap-card__metric",children:[s.jsx("span",{className:"swap-card__metric-label",children:"Price Impact"}),s.jsx("span",{className:`swap-card__metric-value ${U?"swap-card__metric-value--negative":"swap-card__metric-value--positive"}`,children:W(p)})]}),f!==void 0&&s.jsxs("div",{className:"swap-card__metric",children:[s.jsx("span",{className:"swap-card__metric-label",children:"Slippage"}),s.jsxs("span",{className:"swap-card__metric-value",children:[(f/100).toFixed(2),"%"]})]}),g!==void 0&&s.jsxs("div",{className:"swap-card__metric",children:[s.jsx("span",{className:"swap-card__metric-label",children:"Network Fee"}),s.jsxs("span",{className:"swap-card__metric-value",children:[g.toFixed(6)," SOL"]})]})]}),M&&s.jsxs("div",{className:"swap-card__warning",children:[s.jsx("div",{className:"swap-card__warning-icon",children:"⚠"}),s.jsxs("div",{className:"swap-card__warning-content",children:[s.jsx("span",{className:"swap-card__warning-title",children:"High Price Impact"}),s.jsx("span",{className:"swap-card__warning-text",children:"Consider using a smaller amount to reduce slippage."})]})]}),s.jsxs("div",{className:"swap-card__actions",children:[s.jsx(w,{variant:"primary",onClick:T,label:"Execute Swap",loadingLabel:"Executing...",isLoading:i}),s.jsx(w,{onClick:q,label:"Refresh Quote"}),s.jsx(w,{onClick:A,label:"Check Slippage"}),s.jsx(w,{onClick:$,label:`About ${h}`})]}),N&&s.jsx("div",{className:`swap-card__action-result swap-card__action-result--${l}`,children:N}),s.jsxs("div",{className:"swap-card__footer",children:[v&&s.jsxs("span",{className:"swap-card__quote-id",children:["Quote: ",z(v,6,4)]}),s.jsx("span",{className:"swap-card__status",children:"Ready to execute"})]})]})})}const y=document.getElementById("solana-swap-preview-root");y&&O.createRoot(y).render(s.jsx(Q,{}));
