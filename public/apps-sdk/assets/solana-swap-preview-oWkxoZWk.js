import{j as s,u as P,r as g}from"./use-openai-global-D7K5F0u7.js";/* empty css                   *//* empty css                    */import{c as q}from"./client-CWA1JIkp.js";import{u as R}from"./use-call-tool-DR7G8J7E.js";import{u as Q}from"./use-send-followup-B7QKrV0A.js";import{u as D}from"./use-theme-B2-Ffiq-.js";import{g as b}from"./utils-B17YD0uM.js";function c(...e){for(const a of e)if(typeof a=="string"&&a.trim())return a.trim()}function u(...e){for(const a of e){if(typeof a=="number"&&Number.isFinite(a))return a;if(typeof a=="string"){const n=Number(a);if(Number.isFinite(n))return n}}}function k(e){return e?e.slice(0,4).toUpperCase():"TOKEN"}function S(e){return e===void 0?"—":Math.abs(e)>=1?e.toLocaleString("en-US",{maximumFractionDigits:4}):e.toLocaleString("en-US",{maximumFractionDigits:6})}function z(e){return e===void 0?"—":`${e>=0?"+":""}${e.toFixed(2)}%`}function G(e,a=4,n=4){return e.length<=a+n+3?e:`${e.slice(0,a)}…${e.slice(-n)}`}function y({symbol:e,imageUrl:a,size:n=56}){const[o,l]=g.useState(!1),p=a&&!o;return s.jsx("div",{className:"swap-token-icon",style:{width:n,height:n},children:p?s.jsx("img",{src:a,alt:e,onError:()=>l(!0),referrerPolicy:"no-referrer"}):s.jsx("span",{className:"swap-token-icon__fallback",style:{fontSize:n*.3},children:e.slice(0,2)})})}function H({fromSymbol:e,fromAmount:a,fromImage:n,toSymbol:o,toAmount:l,toImage:p}){return s.jsxs("div",{className:"swap-flow",children:[s.jsxs("div",{className:"swap-flow__side",children:[s.jsx(y,{symbol:e,imageUrl:n,size:56}),s.jsxs("div",{className:"swap-flow__info",children:[s.jsx("span",{className:"swap-flow__amount",children:a}),s.jsx("span",{className:"swap-flow__symbol",children:e})]})]}),s.jsx("div",{className:"swap-flow__arrow",children:s.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",children:s.jsx("path",{d:"M5 12h14M13 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),s.jsxs("div",{className:"swap-flow__side swap-flow__side--to",children:[s.jsx(y,{symbol:o,imageUrl:p,size:56}),s.jsxs("div",{className:"swap-flow__info",children:[s.jsx("span",{className:"swap-flow__amount swap-flow__amount--receive",children:l}),s.jsx("span",{className:"swap-flow__symbol",children:o})]})]})]})}function w({onClick:e,label:a,loadingLabel:n,isLoading:o,disabled:l,variant:p="secondary"}){return s.jsx("button",{className:`swap-action-btn swap-action-btn--${p}`,onClick:e,disabled:o||l,children:o?n||"Loading...":a})}function J(){const e=P("toolOutput"),a=D(),{callTool:n,isLoading:o}=R(),l=Q(),[p,_]=g.useState("idle"),[j,x]=g.useState(null),t=e?e.result??e.quote??e:null;if(!t)return s.jsx("div",{className:"swap-container","data-theme":a,children:s.jsxs("div",{className:"swap-loading",children:[s.jsx("div",{className:"swap-loading__spinner"}),s.jsx("span",{children:"Building swap quote..."})]})});const r=c(t.inputMint),i=c(t.outputMint),F=c(t.inputToken?.symbol)??k(r),h=c(t.outputToken?.symbol)??k(i),U=c(t.inputToken?.imageUrl,t.inputToken?.logoUri,t.inputLogo,r?b(r):void 0),L=c(t.outputToken?.imageUrl,t.outputToken?.logoUri,t.outputLogo,i?b(i):void 0),m=u(t.amountUi,t.inAmountUi),T=u(t.expectedOutputUi,t.outAmountUi),d=u(t.priceImpactPct),f=u(t.slippageBps),N=u(t.networkFeeSol),E=c(t.route,t.routeLabel)??"Jupiter",v=c(t.quoteId,t.swapId),M=d!==void 0&&d>1,A=d!==void 0&&d<0,C=async()=>{if(!r||!i)return;_("idle"),x(null),await n("solana_swap_execute",{inputMint:r,outputMint:i,amount:m,slippageBps:f||100})?(_("success"),x("Swap executed successfully!")):(_("error"),x("Failed to execute swap"))},$=async()=>{i&&await n("slippage_sentinel",{token_out:i,token_in:r,amount_in_ui:m})},B=async()=>{await l(`Tell me more about ${h} (${i})`)},O=async()=>{!r||!i||await n("solana_swap_preview",{inputMint:r,outputMint:i,amount:m})};return s.jsx("div",{className:"swap-container","data-theme":a,children:s.jsxs("div",{className:"swap-card",children:[s.jsxs("div",{className:"swap-card__header",children:[s.jsx("span",{className:"swap-card__title",children:"Swap Preview"}),s.jsx("span",{className:"swap-card__badge",children:E})]}),s.jsx(H,{fromSymbol:F,fromAmount:S(m),fromImage:U,toSymbol:h,toAmount:S(T),toImage:L}),s.jsxs("div",{className:"swap-card__metrics",children:[d!==void 0&&s.jsxs("div",{className:"swap-card__metric",children:[s.jsx("span",{className:"swap-card__metric-label",children:"Price Impact"}),s.jsx("span",{className:`swap-card__metric-value ${A?"swap-card__metric-value--negative":"swap-card__metric-value--positive"}`,children:z(d)})]}),f!==void 0&&s.jsxs("div",{className:"swap-card__metric",children:[s.jsx("span",{className:"swap-card__metric-label",children:"Slippage"}),s.jsxs("span",{className:"swap-card__metric-value",children:[(f/100).toFixed(2),"%"]})]}),N!==void 0&&s.jsxs("div",{className:"swap-card__metric",children:[s.jsx("span",{className:"swap-card__metric-label",children:"Network Fee"}),s.jsxs("span",{className:"swap-card__metric-value",children:[N.toFixed(6)," SOL"]})]})]}),M&&s.jsxs("div",{className:"swap-card__warning",children:[s.jsx("div",{className:"swap-card__warning-icon",children:"⚠"}),s.jsxs("div",{className:"swap-card__warning-content",children:[s.jsx("span",{className:"swap-card__warning-title",children:"High Price Impact"}),s.jsx("span",{className:"swap-card__warning-text",children:"Consider using a smaller amount to reduce slippage."})]})]}),s.jsxs("div",{className:"swap-card__actions",children:[s.jsx(w,{variant:"primary",onClick:C,label:"Execute Swap",loadingLabel:"Executing...",isLoading:o}),s.jsx(w,{onClick:O,label:"Refresh Quote"}),s.jsx(w,{onClick:$,label:"Check Slippage"}),s.jsx(w,{onClick:B,label:`About ${h}`})]}),j&&s.jsx("div",{className:`swap-card__action-result swap-card__action-result--${p}`,children:j}),s.jsxs("div",{className:"swap-card__footer",children:[v&&s.jsxs("span",{className:"swap-card__quote-id",children:["Quote: ",G(v,6,4)]}),s.jsx("span",{className:"swap-card__status",children:"Ready to execute"})]})]})})}const I=document.getElementById("solana-swap-preview-root");I&&q.createRoot(I).render(s.jsx(J,{}));
