import{j as e,u as E,r as u}from"./use-openai-global-C-kWgFLb.js";import{c as T}from"./client-rURR1_t4.js";import{u as B,a as w}from"./use-theme-Bge9D-4o.js";import{u as x}from"./use-open-external-CCjEvhCn.js";const v={normal:"#A8A878",fire:"#F08030",water:"#6890F0",electric:"#F8D030",grass:"#78C850",ice:"#98D8D8",fighting:"#C03028",poison:"#A040A0",ground:"#E0C068",flying:"#A890F0",psychic:"#F85888",bug:"#A8B820",rock:"#B8A038",ghost:"#705898",dragon:"#7038F8",dark:"#705848",steel:"#B8B8D0",fairy:"#EE99AC","???":"#68A090"},P={brn:"üî•",psn:"‚ò†Ô∏è",tox:"‚ò†Ô∏è",par:"‚ö°",slp:"üí§",frz:"‚ùÑÔ∏è",confusion:"üí´"};function k(s,n=8){return s?s.length<=n*2+3?s:`${s.slice(0,n)}...${s.slice(-4)}`:"‚Äî"}function M(s){return s.toLowerCase().replace(/[^a-z0-9]/g,"").replace(/^nidoran.*/,n=>n.includes("f")?"nidoranf":"nidoranm")}function R(s,n=!1){const a=M(s);return`https://play.pokemonshowdown.com/sprites/${n?"ani-back":"ani"}/${a}.gif`}function $(s){return s&&v[s.toLowerCase()]||v["???"]}function W(s){return s===void 0||s===1?null:s===0?{label:"IMMUNE",color:"#525252"}:s===.25?{label:"¬º√ó",color:"#ef4444"}:s===.5?{label:"¬Ω√ó",color:"#f97316"}:s===2?{label:"2√ó",color:"#22c55e"}:s===4?{label:"4√ó",color:"#10b981"}:null}function q(s){return s>50?"#22c55e":s>25?"#eab308":"#ef4444"}function D(s){return s.yourTeam||s.yourMoves||s.availableActions||s.yourActive||s.waiting&&s.battleId?"battlefield":s.challenges||s.data?"challenges":s.submitted!==void 0?"move":s.matched!==void 0||s.position!==void 0?"queue":s.deposits?"deposits":s.winner||s.player1||s.player2?"wager_status":s.challengeId||s.wagerId||s.battleRoomId||s.roomId?"success":"unknown"}function p({size:s=20}){return e.jsxs("svg",{width:s,height:s,viewBox:"0 0 32 32",fill:"none",children:[e.jsx("circle",{cx:"16",cy:"16",r:"15",fill:"#fff",stroke:"#333",strokeWidth:"2"}),e.jsx("path",{d:"M1 16h30",stroke:"#333",strokeWidth:"2"}),e.jsx("path",{d:"M1 16a15 15 0 0 1 30 0",fill:"#ef4444"}),e.jsx("circle",{cx:"16",cy:"16",r:"5",fill:"#fff",stroke:"#333",strokeWidth:"2"}),e.jsx("circle",{cx:"16",cy:"16",r:"2.5",fill:"#333"})]})}function h({status:s}){const n={pending:{label:"Pending",className:"poke-badge--warning"},active:{label:"Active",className:"poke-badge--success"},matched:{label:"Matched!",className:"poke-badge--info"},completed:{label:"Completed",className:"poke-badge--primary"},cancelled:{label:"Cancelled",className:"poke-badge--neutral"},waiting:{label:"In Queue",className:"poke-badge--cyan"},confirmed:{label:"Confirmed",className:"poke-badge--success"},yourturn:{label:"Your Turn!",className:"poke-badge--success"}},a=n[s.toLowerCase()]||n.pending;return e.jsx("span",{className:`poke-badge ${a.className}`,children:a.label})}function _({amount:s,size:n="md"}){const a={sm:"poke-wager--sm",md:"poke-wager--md",lg:"poke-wager--lg"}[n];return e.jsxs("div",{className:`poke-wager ${a}`,children:[e.jsxs("span",{className:"poke-wager__value",children:["$",s]}),e.jsx("span",{className:"poke-wager__unit",children:"USDC"})]})}function b({type:s}){return e.jsx("span",{className:"poke-type-badge",style:{backgroundColor:$(s)},children:s.toUpperCase()})}function g({percent:s,size:n="md"}){const a=q(s);return e.jsxs("div",{className:`poke-hp-bar poke-hp-bar--${n}`,children:[e.jsx("div",{className:"poke-hp-bar__fill",style:{width:`${Math.max(0,Math.min(100,s))}%`,backgroundColor:a}}),e.jsxs("span",{className:"poke-hp-bar__text",children:[Math.round(s),"%"]})]})}function f({name:s,back:n=!1,size:a=96,fainted:t=!1}){const[c,r]=u.useState(!1),d=R(s,n);return c?e.jsx("div",{className:"poke-sprite-fallback",style:{width:a,height:a},children:"?"}):e.jsx("img",{src:d,alt:s,className:`poke-sprite ${t?"poke-sprite--fainted":""}`,style:{width:a,height:a},onError:()=>r(!0)})}function O({team:s}){const n=[0,1,2,3,4,5];return e.jsx("div",{className:"poke-team-indicator",children:n.map(a=>{const t=s[a],c=t&&!t.fainted;return e.jsx("div",{className:`poke-team-slot ${c?"poke-team-slot--alive":"poke-team-slot--fainted"}`,title:t?.name,children:e.jsx(p,{size:12})},a)})})}function U({move:s,battleId:n,onResult:a}){const{call:t,loading:c}=w(),r=W(s.effectiveness),d=$(s.type),o=async()=>{if(!s.canUse||c)return;const i=await t("pokedexter_make_move",{battleId:n,action:`move ${s.slot}`});a?.(i)};return e.jsxs("button",{className:`poke-move-btn ${s.canUse?"":"poke-move-btn--disabled"}`,style:{"--type-color":d},onClick:o,disabled:!s.canUse||c,children:[e.jsxs("div",{className:"poke-move-btn__header",children:[e.jsx("span",{className:"poke-move-btn__name",children:s.name}),r&&e.jsx("span",{className:"poke-move-btn__eff",style:{color:r.color},children:r.label})]}),e.jsxs("div",{className:"poke-move-btn__footer",children:[s.type&&e.jsx(b,{type:s.type}),e.jsxs("span",{className:"poke-move-btn__pp",children:["PP ",s.pp,"/",s.maxpp]}),s.basePower>0&&e.jsxs("span",{className:"poke-move-btn__bp",children:[s.basePower," BP"]})]}),c&&e.jsx("div",{className:"poke-move-btn__loading"})]})}function z({pokemon:s,battleId:n,onResult:a}){const{call:t,loading:c}=w(),r=async()=>{if(c)return;const d=await t("pokedexter_make_move",{battleId:n,action:`switch ${s.slot}`});a?.(d)};return e.jsxs("button",{className:"poke-switch-btn",onClick:r,disabled:c,children:[e.jsx(f,{name:s.name,size:40}),e.jsxs("div",{className:"poke-switch-btn__info",children:[e.jsx("span",{className:"poke-switch-btn__name",children:s.name}),e.jsx(g,{percent:s.hpPercent,size:"sm"})]}),s.status&&e.jsx("span",{className:"poke-switch-btn__status",children:P[s.status]||s.status}),c&&e.jsx("div",{className:"poke-switch-btn__loading"})]})}function F({payload:s}){const{openExternal:n}=x(),[a,t]=u.useState(null),[c,r]=u.useState(!1),d=s.battleId||s.actualRoomId||"",o=s.yourActive,i=s.opponent,C=s.availableActions?.moves||s.yourMoves||[],A=s.availableActions?.switches||s.yourSwitches||[],I=s.availableActions?.canMove??C.some(l=>l.canUse),j=s.availableActions?.canSwitch??A.length>0,m=s.availableActions?.forceSwitch||!1;s.waiting;const S=()=>{n(`https://poke.dexter.cash/battle/${d}`)};return s.waiting?e.jsxs("div",{className:"poke-view",children:[e.jsxs("div",{className:"poke-battlefield-waiting",children:[e.jsx(p,{size:32}),e.jsx("span",{children:s.message||"Waiting for your turn..."})]}),d&&e.jsx("button",{className:"poke-watch-btn",onClick:S,children:"Watch Battle ‚Üó"})]}):e.jsxs("div",{className:"poke-view poke-battlefield",children:[i&&e.jsxs("div",{className:"poke-battlefield__opponent",children:[i.activePokemon&&e.jsxs("div",{className:"poke-pokemon-display poke-pokemon-display--opponent",children:[e.jsx(f,{name:i.activePokemon,size:96}),e.jsxs("div",{className:"poke-pokemon-info",children:[e.jsx("div",{className:"poke-pokemon-name",children:i.activePokemon}),i.activeTypes&&e.jsx("div",{className:"poke-pokemon-types",children:i.activeTypes.map(l=>e.jsx(b,{type:l},l))}),i.team?.find(l=>l.active)&&e.jsx(g,{percent:i.team.find(l=>l.active).hp})]})]}),i.team&&i.team.length>0&&e.jsx("div",{className:"poke-opponent-team",children:e.jsxs("span",{className:"poke-opponent-team__label",children:[i.remainingCount,"/",i.revealedCount," alive",6-(i.revealedCount||0)>0&&` ‚Ä¢ ${6-(i.revealedCount||0)} unrevealed`]})})]}),o&&e.jsxs("div",{className:"poke-battlefield__you",children:[e.jsxs("div",{className:"poke-pokemon-display poke-pokemon-display--you",children:[e.jsx(f,{name:o.name,back:!0,size:96}),e.jsxs("div",{className:"poke-pokemon-info",children:[e.jsxs("div",{className:"poke-pokemon-name",children:[o.name,o.status&&e.jsx("span",{className:"poke-status-icon",children:P[o.status]||`[${o.status}]`})]}),o.types&&e.jsx("div",{className:"poke-pokemon-types",children:o.types.map(l=>e.jsx(b,{type:l},l))}),e.jsx(g,{percent:o.hpPercent}),o.ability&&e.jsxs("div",{className:"poke-pokemon-ability",children:["Ability: ",o.ability]})]})]}),s.yourTeam&&e.jsx(O,{team:s.yourTeam})]}),e.jsxs("div",{className:"poke-battlefield__actions",children:[m&&e.jsx("div",{className:"poke-force-switch-banner",children:"‚ö†Ô∏è Must switch Pokemon!"}),a&&e.jsx("div",{className:"poke-action-result",children:a}),!m&&I&&!c&&e.jsx("div",{className:"poke-moves-grid",children:C.map(l=>e.jsx(U,{move:l,battleId:d,onResult:N=>t(N?.submitted||"Move sent!")},l.slot))}),(m||c)&&j&&e.jsx("div",{className:"poke-switches-list",children:A.map(l=>e.jsx(z,{pokemon:l,battleId:d,onResult:N=>t(N?.submitted||"Switch sent!")},l.slot))}),!m&&j&&e.jsx("button",{className:"poke-toggle-switches",onClick:()=>r(!c),children:c?"‚Üê Back to Moves":"Switch Pokemon ‚Üí"})]}),d&&e.jsx("button",{className:"poke-watch-btn",onClick:S,children:"Watch on poke.dexter.cash ‚Üó"})]})}function L({challenge:s}){const{call:n,loading:a,result:t}=w(),c=async()=>{await n("pokedexter_accept_challenge",{challengeId:s.id})};return t?e.jsx("div",{className:"poke-challenge-card poke-challenge-card--accepted",children:e.jsxs("div",{className:"poke-challenge-accepted",children:[e.jsx("span",{className:"poke-challenge-accepted__icon",children:"‚úì"}),e.jsx("span",{children:"Challenge Accepted!"})]})}):e.jsxs("div",{className:"poke-challenge-card",children:[e.jsxs("div",{className:"poke-challenge-header",children:[e.jsxs("div",{className:"poke-challenge-info",children:[e.jsx("span",{className:"poke-challenge-user",children:s.challengerId||k(s.challengerWallet)||"Anonymous"}),e.jsx("span",{className:"poke-challenge-format",children:s.format||"gen9randombattle"})]}),e.jsx(_,{amount:s.amount})]}),e.jsxs("div",{className:"poke-challenge-footer",children:[e.jsxs("span",{className:"poke-challenge-id",children:["ID: ",s.id]}),e.jsx("button",{className:"poke-accept-btn",onClick:c,disabled:a,children:a?"Accepting...":"‚öîÔ∏è Accept"})]})]})}function V({challenges:s}){const[n,a]=u.useState(!1),t=n?s:s.slice(0,4);return e.jsx("div",{className:"poke-view",children:s.length===0?e.jsxs("div",{className:"poke-empty",children:[e.jsx(p,{size:48}),e.jsx("p",{children:"No open challenges right now"}),e.jsx("span",{children:"Create one to start battling!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"poke-challenges-list",children:t.map(c=>e.jsx(L,{challenge:c},c.id))}),s.length>4&&e.jsx("button",{className:"poke-show-more",onClick:()=>a(!n),children:n?"Show Less":`Show ${s.length-4} more`})]})})}function G({payload:s}){const{openExternal:n}=x(),a=s.wagerId||s.id,t=s.battleRoomId||s.roomId,c=s.winner?"completed":s.status==="active"?"active":"pending";return e.jsxs("div",{className:"poke-view",children:[e.jsxs("div",{className:"poke-wager-header",children:[e.jsx("div",{className:"poke-wager-icon",children:"‚öîÔ∏è"}),e.jsxs("div",{className:"poke-wager-info",children:[e.jsx("span",{className:"poke-wager-title",children:"Wager Match"}),e.jsxs("span",{className:"poke-wager-id",children:["#",a]})]}),e.jsxs("div",{className:"poke-wager-meta",children:[e.jsx(_,{amount:s.amount||0}),e.jsx(h,{status:c})]})]}),e.jsxs("div",{className:"poke-players",children:[e.jsxs("div",{className:`poke-player ${s.player1?.deposited?"poke-player--ready":""}`,children:[e.jsx("span",{className:"poke-player-label",children:"Player 1"}),s.player1?.deposited&&e.jsx("span",{className:"poke-player-check",children:"‚úì"}),e.jsx("span",{className:"poke-player-wallet",children:k(s.player1?.wallet||s.player1?.userId)||"‚Äî"})]}),e.jsxs("div",{className:`poke-player ${s.player2?.deposited?"poke-player--ready":""}`,children:[e.jsx("span",{className:"poke-player-label",children:"Player 2"}),s.player2?.deposited&&e.jsx("span",{className:"poke-player-check",children:"‚úì"}),e.jsx("span",{className:"poke-player-wallet",children:k(s.player2?.wallet||s.player2?.userId)||"Waiting..."})]})]}),s.winner&&e.jsxs("div",{className:"poke-winner",children:[e.jsx("span",{className:"poke-winner-icon",children:"üèÜ"}),e.jsxs("div",{className:"poke-winner-info",children:[e.jsx("span",{className:"poke-winner-label",children:"Winner"}),e.jsx("span",{className:"poke-winner-name",children:s.winner})]})]}),t&&e.jsxs("button",{className:"poke-battle-link",onClick:()=>n(`https://poke.dexter.cash/battle/${t}`),children:["Watch Battle: ",t," ‚Üó"]})]})}function Q({payload:s}){const{openExternal:n}=x(),a=s.battleRoomId||s.roomId;return e.jsx("div",{className:"poke-view",children:s.matched?e.jsxs("div",{className:"poke-matched",children:[e.jsx("span",{className:"poke-matched-icon",children:"‚öîÔ∏è"}),e.jsxs("div",{className:"poke-matched-info",children:[e.jsx("span",{className:"poke-matched-title",children:"Match Found!"}),a&&e.jsxs("button",{className:"poke-matched-link",onClick:()=>n(`https://poke.dexter.cash/battle/${a}`),children:["Join Battle: ",a," ‚Üó"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"poke-queue-metrics",children:[e.jsxs("div",{className:"poke-queue-metric",children:[e.jsx("span",{className:"poke-queue-metric__label",children:"POSITION"}),e.jsxs("span",{className:"poke-queue-metric__value",children:["#",s.position||1]})]}),e.jsxs("div",{className:"poke-queue-metric",children:[e.jsx("span",{className:"poke-queue-metric__label",children:"IN QUEUE"}),e.jsx("span",{className:"poke-queue-metric__value",children:s.queueSize||1})]}),e.jsxs("div",{className:"poke-queue-metric",children:[e.jsx("span",{className:"poke-queue-metric__label",children:"WAGER"}),e.jsxs("span",{className:"poke-queue-metric__value",children:["$",s.amount||"‚Äî"]})]})]}),e.jsxs("div",{className:"poke-searching",children:[e.jsx("div",{className:"poke-searching-icon",children:e.jsx(p,{size:24})}),e.jsxs("div",{className:"poke-searching-info",children:[e.jsx("span",{className:"poke-searching-text",children:"Searching for opponent..."}),e.jsx("span",{className:"poke-searching-format",children:s.format||"gen9randombattle"})]})]})]})})}function H({payload:s}){const n=s.deposits?.player1?.deposited,a=s.deposits?.player2?.deposited,t=n&&a;return e.jsxs("div",{className:"poke-view",children:[e.jsxs("div",{className:"poke-deposit-status",children:[e.jsxs("div",{className:`poke-deposit-player ${n?"poke-deposit-player--ready":""}`,children:[e.jsx("span",{className:"poke-deposit-label",children:"Player 1"}),e.jsx("span",{className:"poke-deposit-icon",children:n?"‚úì":"‚ó∑"}),e.jsx("span",{className:"poke-deposit-state",children:n?"Deposited":"Pending"})]}),e.jsxs("div",{className:`poke-deposit-player ${a?"poke-deposit-player--ready":""}`,children:[e.jsx("span",{className:"poke-deposit-label",children:"Player 2"}),e.jsx("span",{className:"poke-deposit-icon",children:a?"‚úì":"‚ó∑"}),e.jsx("span",{className:"poke-deposit-state",children:a?"Deposited":"Pending"})]})]}),s.totalPot&&e.jsxs("div",{className:"poke-pot",children:[e.jsx("span",{className:"poke-pot-label",children:"Total Pot"}),e.jsx(_,{amount:s.totalPot,size:"lg"})]}),t&&e.jsxs("div",{className:"poke-ready",children:[e.jsx("span",{className:"poke-ready-icon",children:"‚ö°"}),e.jsx("span",{className:"poke-ready-text",children:"Battle Ready!"})]})]})}function Y({payload:s}){return e.jsxs("div",{className:"poke-view",children:[e.jsx("div",{className:"poke-move-display",children:e.jsx("span",{className:"poke-move-submitted",children:s.submitted})}),e.jsxs("div",{className:"poke-move-metrics",children:[e.jsxs("div",{className:"poke-move-metric",children:[e.jsx("span",{className:"poke-move-metric__label",children:"BATTLE ID"}),e.jsx("span",{className:"poke-move-metric__value",children:s.battleId||"‚Äî"})]}),e.jsxs("div",{className:"poke-move-metric",children:[e.jsx("span",{className:"poke-move-metric__label",children:"STATUS"}),e.jsx("span",{className:"poke-move-metric__value",children:"Recorded"})]})]}),s.note&&e.jsx("p",{className:"poke-move-note",children:s.note})]})}function J({payload:s}){const{openExternal:n}=x(),a=s.battleRoomId||s.roomId;return e.jsxs("div",{className:"poke-view",children:[e.jsxs("div",{className:"poke-success-banner",children:[e.jsx("span",{className:"poke-success-icon",children:"‚úì"}),e.jsx("span",{className:"poke-success-text",children:"Success!"})]}),e.jsxs("div",{className:"poke-success-details",children:[s.amount&&e.jsxs("div",{className:"poke-success-detail",children:[e.jsx("span",{className:"poke-success-detail__label",children:"WAGER"}),e.jsxs("span",{className:"poke-success-detail__value",children:["$",s.amount]})]}),s.format&&e.jsxs("div",{className:"poke-success-detail",children:[e.jsx("span",{className:"poke-success-detail__label",children:"FORMAT"}),e.jsx("span",{className:"poke-success-detail__value",children:s.format})]}),s.challengeId&&e.jsxs("div",{className:"poke-success-detail",children:[e.jsx("span",{className:"poke-success-detail__label",children:"CHALLENGE"}),e.jsx("span",{className:"poke-success-detail__value",children:s.challengeId})]}),s.wagerId&&e.jsxs("div",{className:"poke-success-detail",children:[e.jsx("span",{className:"poke-success-detail__label",children:"WAGER"}),e.jsx("span",{className:"poke-success-detail__value",children:s.wagerId})]})]}),a&&e.jsx("button",{className:"poke-enter-battle",onClick:()=>n(`https://poke.dexter.cash/battle/${a}`),children:"‚ö° Enter Battle Room ‚Üó"}),s.escrowAddress&&e.jsxs("div",{className:"poke-escrow",children:[e.jsx("span",{className:"poke-escrow-label",children:"Deposit To"}),e.jsx("code",{className:"poke-escrow-address",children:k(s.escrowAddress,16)})]})]})}function K(){const s=E("toolOutput"),n=B();if(!s)return e.jsx("div",{className:"poke-container","data-theme":n,children:e.jsxs("div",{className:"poke-loading",children:[e.jsx(p,{size:24}),e.jsx("span",{children:"Loading..."})]})});if(s.error||s.ok===!1)return e.jsx("div",{className:"poke-container","data-theme":n,children:e.jsx("div",{className:"poke-error",children:s.error||"Operation failed"})});const a=D(s),t=s.challenges||s.data||[],c=a==="battlefield"&&!s.waiting&&(s.availableActions?.canMove||s.availableActions?.canSwitch),r={challenges:"Open Challenges",wager_status:"Wager Status",queue:"Queue Status",deposits:"Deposit Status",battlefield:"Battle",move:"Move Submitted",success:"Success",unknown:"Pokedexter"};return e.jsx("div",{className:"poke-container","data-theme":n,children:e.jsxs("div",{className:"poke-card",children:[e.jsxs("div",{className:"poke-header",children:[e.jsxs("div",{className:"poke-header-left",children:[e.jsx(p,{size:18}),e.jsx("span",{className:"poke-title",children:r[a]})]}),a==="challenges"&&e.jsxs("span",{className:"poke-challenges-count",children:[t.length," available"]}),a==="queue"&&e.jsx(h,{status:s.matched?"matched":"waiting"}),a==="move"&&e.jsx(h,{status:"confirmed"}),a==="battlefield"&&e.jsx(h,{status:c?"yourturn":"waiting"})]}),a==="challenges"&&e.jsx(V,{challenges:t}),a==="wager_status"&&e.jsx(G,{payload:s}),a==="queue"&&e.jsx(Q,{payload:s}),a==="deposits"&&e.jsx(H,{payload:s}),a==="battlefield"&&e.jsx(F,{payload:s}),a==="move"&&e.jsx(Y,{payload:s}),a==="success"&&e.jsx(J,{payload:s})]})})}const y=document.getElementById("pokedexter-root");y&&T.createRoot(y).render(e.jsx(K,{}));
